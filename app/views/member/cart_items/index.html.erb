<div class='container'>
    <div class='row'>
        <div class='col-3'>
            <h3>ショッピングカート</h3>
        </div>
        <div class='col-3 offset-6'>
            <button type="button" class="btn btn-danger btn-sm",class="text-white">
                <%= link_to "カートを空にする", all_destroy_cart_items_path, method: :delete%>
            </button>
        </div>
    </div>
    <div class='row'>
        <div class='col'>
            <table class='table table-bordered'>
                <tr class="table-secondary">
                    <th>商品名</th>
                    <th>単価(税込)</th>
                    <th>数量</th>
                    <th>小計</th>
                    <th></th>
                </tr>
                <!--合計金額totalの初期化-->
                <% total = 0 %>
                <% @cart_items.each do |item| %>
                <tr>
                    <td><%= item.name %></td>
                    <td><%= item.price %></td>
                    <td>
                        <% form_with item, url: cart_item_path, method: :patch do |f| %>
                            <%= f.select :quantity, options_for_select(@numbers, {selected: item.quantity.to_i} ) %>
                            <button type="submit" class="btn btn-success">
                                <%= f.submit "変更" %>
                            </button>
                        <% end %>
                    </td>
                    <td>
                        <!--小計の計算-->
                        <% subtotal = (item.price*item.quantity).to_i %>
                        <!--小計を表示-->
                        <%= subtotal %>
                    </td>
                    <td>
                        <!--削除ボタン-->
                        <button type="submit" class="btn btn-danger">
                            <%= link_to "削除する", cart_item_path(cart_item.id, cart_item), method: :delete %>
                        </button>
                    </td>
                </tr>
                <!--アイテムごとに合計金額に加算する-->
                <% total += subtotal %>
            	<% end %>
            </table>
        </div>
    </div>
    <div class='row'>
        <div class='col-3'>
            <button type="submit" class="btn btn-primary btn-sm">
                <%= link_to "買い物を続ける" %>
                <!--link_to "買い物を続ける", items_path, method: :get %>-->
            </button>
        </div>
        <div class='col-3 offset-6'>
            <table class='table table-bordered'>
                <tr><th class="table-secondary">合計金額</th><td><%= total %></td></tr>
            </table>
        </div>
    </div>
    <div class='row justify-content-center'>
        <div class='col-3 offset-4'>
            <button type="submit" class="btn btn-success">
                <%= link_to "情報入力に進む"%>
                <!--link_to "情報入力に進む", new_order_path(cart_item), method: :new %>-->
            </button>
        </div>
    </div>
</div>